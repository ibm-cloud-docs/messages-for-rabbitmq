---
copyright:
  years: 2017,2019
lastupdated: "2019-05-02"

keywords: rabbitmq, databases, connection strings

subcollection: messages-for-rabbitmq

---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:tip: .tip}


# Creating Users and Getting Connection Strings
{: #connection-strings}

In order to connect to {{site.data.keyword.messages-for-rabbitmq_full}}, you need some users and some connection strings. Connection Strings for your deployment are displayed on the _Dashboard Overview_, in the _Endpoints_ panel.

![Endpoints panel](images/getting-started-endpoints-panel.png)

You can also grab connection strings from the [CLI](/docs/databases-cli-plugin?topic=databases-cli-plugin-cdb-reference#deployment-connections) and the [API](https://{DomainName}/apidocs/cloud-databases-api#discover-connection-information-for-a-deployment-f-e81026).

A {{site.data.keyword.messages-for-rabbitmq}} deployment is provisioned with an admin user, and after you [set the admin password](/docs/messages-for-rabbitmq?topic=messages-for-rabbitmq-admin-password), you can use its credentials to connect to your deployment.
{: .tip}

## Credentials and Connection Strings for additional users

Access to your {{site.data.keyword.messages-for-rabbitmq}} deployment is not limited to the root user. You can create users by using the _Service Credentials_ panel, the {{site.data.keyword.IBM_notm}} CLI, or through the {{site.data.keyword.IBM_notm}} {{site.data.keyword.databases-for}} API. 

All users on your deployment can use the connection strings, including connection strings for either public or private endpoints.

Not all users get the same privileges with respect to administering RabbitMQ. To read more about which users get what privileges see the [Managing Users](/docs/messages-for-rabbitmq?topic=messages-for-rabbitmq-user-management) page.

### From _Service Credentials_

1. Navigate to the service dashboard for your service.
2. Click _Service Credentials_ to open the _Service Credentials_ panel.
3. Click **New Credential**.
4. Choose a descriptive name for your new credential. 
5. (Optional) Specify whether the new credentials use a public or private endpoint. Use either `{ "service-endpoints": "public" }` / `{ "service-endpoints": "private" }` in the _Add Inline Configuration Parameters_ field to generate connection strings that use the specified endpoint. Use of the endpoint is not enforced, it just controls which hostnames are in the connection strings. Public endpoints are generated by default.
6. Click **Add** to provision the new credentials. A username and password, and an associated RabbitMQ user is auto-generated.

The new credentials appear in the table, and the connection strings are available as JSON in a click-to-copy field under _View Credentials_.

### From the CLI

If you manage your service through the {{site.data.keyword.cloud_notm}} CLI and the [cloud databases plug-in](/docs/cli?topic=cli-install-ibmcloud-cli), you can create a new user with `cdb user-create`. For example, to create a new user for an "example-deployment", use the following command.
```
ibmcloud cdb user-create example-deployment <newusername> <newpassword>
```

Once the task is finished, you can retrieve the new user's connection strings with the `ibmcloud cdb deployment-connections` command.
```
ibmcloud cdb deployment-connections example-deployment -u <newusername> [--endpoint-type <endpoint type>]
```

Full connection information is returned by the `ibmcloud cdb deployment-connections` command with the `--all` flag. To retrieve all the connection information for a deployment named  "example-deployment", use the following command.
```
ibmcloud cdb deployment-connections example-deployment -u <newusername> --all [--endpoint-type <endpoint type>]
```

If you don't specify a user, the `deployment-connections` commands return information for the admin user by default. If you don't specify an endpoint type, the connection string returns the public endpoint by default. If your deployment only has a private endpoint, you have to specify `--endpoint-type private` or the commands return an error. The user and endpoint type is not enforced. You can use any user on your deployment with either endpoint (if both exist on your deployment).

### From the API

The _Foundation Endpoint_ that is shown on the _Overview_ panel of your service provides the base URL to access this deployment through the API. To create and manage users, use the base URL with the `/users` endpoint.
```
curl -X POST 'https://api.{region}.databases.cloud.ibm.com/v4/ibm/deployments/{id}/users' \
-H "Authorization: Bearer $APIKEY" \
-H "Content-Type: application/json" \
-d '{"username":"jane_smith", "password":"newsupersecurepassword"}'
```

To retrieve user's connection strings, use the base URL with the `/users/{userid}/connections` endpoint. You have to specify in the path which user and which type of endpoint (public or private) is used in the returned connection strings. The user and endpoint type is not enforced. You can use any user on your deployment with either endpoint (if both exist on your deployment).
```
curl -X GET -H "Authorization: Bearer $APIKEY" 'https://api.{region}.databases.cloud.ibm.com/v4/ibm/deployments/{id}/users/{userid}/connections/{endpoint_type}'
```

### Adding users to _Service Credentials_ 

Creating a new user from the CLI or API doesn't automatically populate that user's connection strings into _Service Credentials_. If you want to add them there, you can create a new credential with the existing user information.

Enter the user name and password in the JSON field _Add Inline Configuration Parameters_, or specify a file where the JSON information is stored. For example, `{"existing_credentials":{"username":"Robert","password":"supersecure"}}`.

Generating credentials from an existing user does not check for or create that user.
{: tip}

## Connection String Breakdown

### The `amqps` Section

The "amqps" section contains information that is suited for your applications that make connections to RabbitMQ.

Field Name|Index|Description
----------|-----|-----------
`Type`||Type of connection - for RabbitMQ, it is "uri"
`Scheme`||Scheme for a URI - for RabbitMQ, it is "amqps"
`Path`||Path for a uri
`Authentication`|`Username`|The username that you use to connect.
`Authentication`|`Password`|A password for the user - might be shown as `$PASSWORD`
`Authentication`|`Method`|How authentication takes place; "direct" authentication is handled by the driver.
`Hosts`|`0...`|A hostname and port to connect to
`Composed`|`0...`|A URI combining Scheme, Authentication, Host, and Path
`Certificate`|`Name`|The allocated name for the self-signed certificate for database deployment
`Certificate`|`Base64`|A base64 encoded version of the certificate.
{: caption="Table 1. `RabbitMQ`/`uri` connection information" caption-side="top"}

* `0...` indicates that there might be one or more of these entries in an array.

For more information on using this information to connect, see the [Connecting an External Application](/docs/messages-for-rabbitmq?topic=messages-for-rabbitmq-external-app) page.

### The `stomp_ssl` Section

The `stomp_ssl` section contains the information that a STOMP client needs to connect to your deployment.

Field Name|Index|Description
----------|-----|-----------
`Type`||Type of connection - for STOMP, it is `stomp`
`Authentication`|`Username`|The username that you use to connect.
`Authentication`|`Password`|A password for the user - might be shown as `$PASSWORD`
`Authentication`|`Method`|How authentication takes place; "direct" authentication is handled by the driver.
`Hosts`|`0...`|A hostname and port to connect to, also contains the protocol name "stomp-ssl"
`Composed`|`0...`|A URI combining Authentication, Host, and TLS/SSL
`ssl`||The TLS/SSL setting needed for a connection. Should always be `true`.
`Certificate`|`Name`|The allocated name for the self-signed certificate for database deployment
`Certificate`|`Base64`|A base64 encoded version of the certificate.
{: caption="Table 2. `RabbitMQ`/`stomp_ssl` connection information" caption-side="top"}

* `0...` indicates that there might be one or more of these entries in an array.

### The `mqtts` Section

The `mqtts` section contains the information that an MQTT client needs to connect to your deployment.

Field Name|Index|Description
----------|-----|-----------
`Type`||Type of connection - for `MQTTS` , it is `uri`.
`Scheme`|| Scheme for a URI - in this case it is `mqtts`.
`Authentication`|`Username`|The username that you use to connect.
`Authentication`|`Password`|A password for the user - might be shown as `$PASSWORD`
`Authentication`|`Method`|How authentication takes place; "direct" authentication is handled by the driver.
`Hosts`|`0...`|A hostname and port to connect to.
`Composed`|`0...`|A URI combining Authentication, Host, and Port used to connect.
`Certificate`|`Name`|The allocated name for the self-signed certificate for database deployment
`Certificate`|`Base64`|A base64 encoded version of the certificate.
{: caption="Table 2. `RabbitMQ`/`mqtts` connection information" caption-side="top"}

* `0...` indicates that there might be one or more of these entries in an array.

### The CLI and https Sections

The `CLI` section contains information that is suited for the management plugin and command-line clients that make connections to RabbitMQ.

Field Name|Index|Description
----------|-----|-----------
`Bin`||The recommended binary to create a connection; in this case it is `rabbitmqadmin`.
`Composed`||A formatted command to establish a connection to your deployment. The command combines the `Bin` executable, `Environment` variable settings, and uses `Arguments` as command-line parameters.
`Environment`||A list of key/values you set as environment variables.
`Arguments`|`0...`|The information that is passed as arguments to the command shown in the Bin field.
`Certificate`|`Base64`|A self-signed certificate that is used to confirm that an application is connecting to the appropriate server. It is base64 encoded.
`Certificate`|`Name`|The allocated name for the self-signed certificate.
`Type`||The type of package that uses this connection information; in this case `cli`. 
{: caption="Table 3. `rabbitmqadmin`/`cli` connection information" caption-side="top"}

* `0...` indicates that there might be one or more of these entries in an array.

The `https` section contains information that you can use to access the RabbitMQ management plugin via web browser.

Field Name|Index|Description
----------|-----|-----------
`Type`||Type of connection - for RabbitMQ, it is `uri`
`Scheme`||Scheme for a URI - for RabbitMQ, it is `https`
`Path`||Path for a uri
`Authentication`|`Username`|The username that you use to connect.
`Authentication`|`Password`|A password for the user - might be shown as `$PASSWORD`
`Authentication`|`Method`|How authentication takes place; "direct" authentication is handled by the driver.
`Hosts`|`0...`|A hostname and port to connect to
`Composed`|`0...`|A URI combining Scheme, Authentication, Host, and Path
`Certificate`|`Name`|The allocated name for the self-signed certificate for database deployment
`Certificate`|`Base64`|A base64 encoded version of the certificate.
{: caption="Table 4. `https`/`uri` connection information" caption-side="top"}

* `0...` indicates that there might be one or more of these entries in an array.

For more information on using this information, see the [Connecting with the RabbitMQ Management Plugin](/docs/messages-for-rabbitmq?topic=messages-for-rabbitmq-management-plugin) page.







